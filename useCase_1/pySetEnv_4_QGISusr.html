<!--
  Create Stunning Presentations on the Web
  https://revealjs.com/markdown/

https://cdnjs.com/libraries/reveal.js/3.6.0
https://cdnjs.com/libraries/marked
-->

<html>
  <head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/css/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/css/theme/black.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/monokai.min.css">
  </head>
  <style type="text/css">
    .reveal h1,
    .reveal h2,
    .reveal h3,
    .reveal h4,
    .reveal h5,
    .reveal h6 {
      text-transform: none;
    }
  </style>
  <body>
    <div class="reveal">
      <div class="slides">

        <section data-markdown data-separator=">>>" data-separator-vertical="---$">
            <script type="text/template">

![](https://www.python.org/static/img/python-logo.png) 
## QGIS ユーザーのための<br>環境設定
<br>
2021/5/6
>>>

### １．はじめに
- 「Windows キー（以下、Windows）」→「Q」とタイプしてみて下さい。
- 「QGIS Desktop 3.～」が表示される場合は Python が既にインストールされています。
- そうでない場合は
[ダウンロードとインストール](https://www.javadrive.jp/python/install/index1.html)
が必要になります。
- 既にインストールされている場合は下頁の手順で操作を行って下さい。
---

#### Python の場所の確認
- Python は「□\apps\Python37」にあります。
- 「□」の部分は QGIS のインストール先により「C:\OSGeo4W64」か「C:\Program Files\QGIS ~」の何れかになります。
- ご自分の PC でどちらにあるかを確認して、下頁に進んで下さい。
- <span style="font-size:25px; color:red">
  エクスプローラーで実際に移動してフォルダーの部分をクリックして「Cntrl + C」とタイプすると
  次の作業で手間が省けます。
</span>
---

#### 環境変数 Path の追加
- 「Windows + Pause/Break」、左上の「システムの詳細設定」をクリック、
「Alt + N」→「Alt + S」→「P」→「Alt + I」→「Alt + N」で以下の 2 行を追加して下さい。
1. 　□\apps\Python37
2. 　□\apps\Python37\Scripts
- <span style="font-size:25px; color:red">
「□」の部分は上頁で確認したフォルダーを指します。
上頁で「Cntrl + C」とした場合は「1.」の入力が「Cntrl + V」で済みます。<br>
この動作を反復すれば「2.」も「\Scripts」の追加で済みます。
</span>
>>>

### ２．動作確認
- 「Windows + R」で「cmd」と入力して下さい。
- 開いた画面（「
<span style="color:yellow">コマンドプロンプト</span>
」といいます）で「python --version」とタイプして下さい。
- 「Python 3.7.～」と表示されたら OK です。
単に、Python が実行できれば良い、という方は以上で完了です。
- エラーが出た場合は[追加した環境変数Path](#/1/2)
に入力ミスがないかをチェックしてリトライして下さい。
>>>

### ３．VSCode のインストール
- 「VBA」でプログラムを書く時に用いている「Visual Studio Editor」に相当する
「Visual Studio Code（VSCode）」というアプリケーションをインストールします。
- [この記事](https://www.python.jp/python_vscode/windows/setup/install_vscode.html) 
に従って操作を行って下さい。
- QGIS のユーザーは VSCode を終了せず続けて下頁の操作を行って下さい。
---

#### VSCode の設定
- VSCodeで「Cntrl + N」とタイプして開く新しいタブに下頁のデータを貼り付けて下さい。
- もし QGIS が「C:\Program Files\QGIS ～」にインストールされている場合は「osgeo4w64」となっている
3 箇所をそれに合わせて書換えてください。
- 「Cntrl + S」とタイプして「%APPDATA%」→「Code」→「User」に移動して「settings.json」
というファイル名で保存して下さい。
---

- 枠内の全ての行を選択して「Cntl + C」、VSCode で「Cntrl + V」

```json
{
  "terminal.integrated.env.windows": {
      "PATH": "c:\\osgeo4w64\\apps\\Python37;c:\\osgeo4w64\\apps\\Python37\\Scripts;${env:PATH}"
  },
  "python.pythonPath": "c:\\osgeo4w64\\apps\\Python37\\python.exe",
  "terminal.integrated.sendKeybindingsToShell": true,
  "terminal.integrated.automationShell.windows": "C:\\WINDOWS\\System32\\cmd.exe",
  "workbench.editorAssociations": [
      {
          "viewType": "jupyter.notebook.ipynb",
          "filenamePattern": "*.ipynb"
      }
  ],
  "window.zoomLevel": 1,
  "editor.fontSize": 12,
  "editor.renderWhitespace": "boundary",
  "editor.insertSpaces": false,
  "python.formatting.provider": "yapf"
}
```
>>>
以上です。

Let's Enjoy Python Programing

            </script>
        </section>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/2.0.3/marked.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/lib/js/head.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/js/reveal.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/markdown/markdown.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/notes/notes.js"></script>

    <script>
      Reveal.initialize({
        controls: true,
        progress: true,
        center: true,
        history: true,
        plugins: [ RevealMarkdown, RevealNotes ],
        math: {
          mathjax: 'https://cdn.jsdelivr.net/gh/mathjax/mathjax@2.7.8/MathJax.js',
          config:  'TeX-AMS_HTML-full'
        },
        dependencies: [
          {src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/highlight/highlight.js',
              async: true, callback: function() { hljs.initHighlightingOnLoad(); }},
          {src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/plugin/math/math.min.js',
              async: true}
        ]
      });
    </script>
  </body>
</html>